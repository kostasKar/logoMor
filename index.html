<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
  <title>LogoMor</title>
  <link rel='shortcut icon' type='image/x-icon' href='favicon.png'>
  <meta charset="utf-8">

  <!--Online resources-->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inconsolata&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css">
  <script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.min.js"></script>

  <!--Local scripts -->
  <script src="js/logomorApp.js"><</script>
  <script src="js/tasks/argumentResolverTask.js"></script>
  <script src="js/tasks/commandTasks.js"></script>
  <script src="js/tasks/parenthesisTask.js"></script>
  <script src="js/tasks/variableMakerTask.js"></script>
  <script src="js/tasks/staticVariableMaker.js"></script>
  <script src="js/tasks/instructionsBlockTask.js"></script>
  <script src="js/tasks/ifTask.js"></script>
  <script src="js/tasks/ifElseTask.js"></script>
  <script src="js/tasks/repeatTask.js"></script>
  <script src="js/tasks/whileTask.js"></script>
  <script src="js/tasks/untilTask.js"></script>
  <script src="js/interpreter/procedurePrototype.js"></script>
  <script src="js/tasks/procedureTask.js"></script>
  <script src="js/features/variablesSliders.js"></script>
  <script src="js/interpreter/logomorCommands.js"></script>
  <script src="js/libs/codemirrorLogomor/lib/codemirror.js"></script>
  <script src="js/libs/codemirrorLogomor/mode/logomor/logomor.js"></script>
  <script src="js/libs/codemirrorLogomor/addon/edit/matchbrackets.js"></script>
  <script src="js/libs/codemirrorLogomor/addon/edit/closebrackets.js"></script>
  <script src="js/libs/codemirrorLogomor/addon/selection/active-line.js"></script>
  <script src="js/libs/codemirrorLogomor/addon/search/match-highlighter.js"></script>
  <script src="js/libs/codemirrorLogomor/addon/search/matchesonscrollbar.js"></script>
  <script src="js/libs/codemirrorLogomor/addon/scroll/annotatescrollbar.js"></script>
  <script src="js/libs/codemirrorLogomor/addon/scroll/simplescrollbars.js"></script>
  <script src="js/libs/codemirrorLogomor/addon/search/searchcursor.js"></script>
  <script src="js/libs/codemirrorLogomor/addon/hint/show-hint.js"></script>
  <script src="js/libs/codemirrorLogomor/addon/hover/text-hover.js"></script>
  <script src="js/libs/codemirrorLogomor/addon/hover/token-hover.js"></script>
  <script src="js/libs/codemirrorLogomor/addon/display/placeholder.js"></script>
  <script src="js/libs/codemirrorLogomor/addon/comment/comment.js"></script>
  <script src="js/renderer/cameraManipulation.js"></script>
  <script src="js/renderer/drawThings.js"></script>
  <script src="js/renderer/logoMatrixTransformations.js"></script>
  <script src="js/interpreter/debugger.js"></script>
  <script src='js/interpreter/logoParser.js'></script>
  <script src='js/interpreter/memoryController.js'></script>
  <script src="js/interpreter/logoInterpreter.js"></script>
  <script src="js/renderer/sketchBuffer.js"></script>
  <script src="js/features/stlCreator.js"></script>
  <script src="js/interpreter/retainMode.js"></script>
  <script src="js/renderer/logoCommands.js"></script>
  <script src="js/interpreter/randomGenerator.js"></script>
  <script src="js/features/demoProgram.js"></script>
  <script src="js/features/localFileSourceCode.js"></script>
  <script src="js/features/output.js"></script>
  <script src="js/interpreter/error.js"></script>
  <script src="js/features/model.js"></script>
  <script src="js/features/image.js"></script>
  <script src="js/features/sound.js"></script>
  <script src="js/interpreter/waitHandler.js"></script>
  <script src="js/libs/seedramdom/seedrandom.min.js"></script>
  <script src="js/features/positionInfo.js"></script>
  <script src="js/renderer/sketch.js"></script>
  <script src="js/editor/codeEditorConfiguration.js" defer></script>


  <!--Stylesheets-->
  <link rel="stylesheet" type="text/css" href="css/colors.css">
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <link rel="stylesheet" href="js/libs/codemirrorLogomor/addon/hover/text-hover.css">
  <link rel="stylesheet" href="js/libs/codemirrorLogomor/addon/hint/show-hint.css">
  <link rel="stylesheet" href="js/libs/codemirrorLogomor/addon/display/fullscreen.css">
  <link href="js/libs/codemirrorLogomor/addon/scroll/simplescrollbars.css" rel="stylesheet">
  <link href="js/libs/codemirrorLogomor/lib/codemirror.css" rel="stylesheet">
  <link href="js/libs/codemirrorLogomor/theme/logomor-theme.css" rel="stylesheet">


</head>
<body>













<div id="p5_loading"></div>
<div id="CameraInstructions" class="subtleText1">
  <image id="logoIcon" src="favicon.png"></image>
  <h1 class="brightText"> <span class="bigger">L</span>OGO<span class="bigger">M</span>OR</h1>
  <h2 class="brightText">3D Logo Interpreter</h2>
  <label>Left Click: Rotate </label>
  <label>Middle Click: Pan </label>
  <label>Scroll Wheel: Zoom </label>
  <label>Double Click: Reset View</label>
  <label title="Static sketches automatically enable high speed rendering" id="retainModeLabel">Retained Mode: <span id="retainModeValue">On</span></label>
  <label id="fpsLabel">Fps: <span id="fpsValue"></span></label>
</div>

<div id="copyright" class="subtleText2">&copy; 2025 Kostas Karouzos
  <a href = "mailto: &#099;&#107;&#046;&#107;&#097;&#114;&#111;&#117;&#122;&#111;&#115;&#064;&#103;&#109;&#097;&#105;&#108;&#046;&#099;&#111;&#109;">&#099;&#107;&#046;&#107;&#097;&#114;&#111;&#117;&#122;&#111;&#115;&#064;&#103;&#109;&#097;&#105;&#108;&#046;&#099;&#111;&#109;</a>
  <a href="https://github.com/kostasKar/logoMor" class="fab fa-github" target="_blank"></a>
</div>

<div id="drawCanvas"></div>

<div id ="controlsColumnScroll">
  <div id="controlsColumn" class="rtl">

    <div class="menubar">
      <div class="show-on-hover dropdown">
        <div class="dropdown-button">File</div>
        <div class="dropdown-content">
          <div onclick="LM.localSystem.download()">Save</div>
          <div onclick="LM.localSystem.openFile()">Load</div>
          <input id="inp" type='file' style="display:none;" onchange="LM.localSystem.readFile(event)" onclick="this.value=null;" />
          <div onclick="LM.codeMirror.copyShareableSourceCodeLink()">Share</div>
          <hr class="HorizontalRule">
          <div onclick="LM.stlCreator.createASCIISTL()">Export STL</div>
        </div>
      </div>
      <div class="show-on-hover dropdown">
        <div class="dropdown-button">Editor</div>
        <div class="dropdown-content">
          <div onclick="LM.codeMirror.setValue('')">Clear</div>
          <hr class="HorizontalRule">
          <div onclick="LM.codeMirror.undo()">Undo</div>
          <div onclick="LM.codeMirror.redo()">Redo</div>
          <hr class="HorizontalRule">
          <div onclick="LM.codeMirror.increaseEditorFontSize()">Zoom In</div>
          <div onclick="LM.codeMirror.decreaseEditorFontSize()">Zoom Out</div>
          <div onclick="LM.codeMirror.resetEditorFontSize()">Reset Zoom</div>
          <hr class="HorizontalRule">
          <div onclick="let chbx = document.getElementById('toggleHoverHint'); chbx.click(); LM.codeMirror.setOption('textHover', (chbx.checked? true : false))"><input checked type="checkbox" id="toggleHoverHint" style="pointer-events:none"> Hints on Hover</div>
        </div>
      </div>
      <div class="show-on-hover dropdown">
        <div class="dropdown-button">Sketch</div>
        <div class="dropdown-content">
          <div onclick="LM.interpreter.setup()">Run</div>
          <div onclick="LM.interpreter.setup(''); LM.sounds.stopAllAudio()">Stop</div>
          <hr class="HorizontalRule">
          <div onclick="document.getElementById('defaultPenColorPicker').click()">Default Pen Color<input id="defaultPenColorPicker" class="colorPickerInput" type="color" value="#ffffff" onchange="LM.logo.setDefaultHexColor(this.value);LM.retainMode.fireExecution();"/></div>
          <div onclick="document.getElementById('backgroundColorPicker').click()">Background Color<input id="backgroundColorPicker" class="colorPickerInput" type="color" value="#000000" onchange="LM.p5Renderer.setBackgroundColor(this.value);LM.retainMode.fireExecution();"/></div>
        </div>
      </div>
      <div class="show-on-hover dropdown">
        <div class="dropdown-button" onmouseover="LM.demoPrograms.populateExamples(this)">Examples</div>
        <div class="dropdown-content"></div>
      </div>
      <div class="show-on-hover dropdown">
        <div class="dropdown-button">Help</div>
        <div class="dropdown-content">
          <div onclick="window.open('assets/documentation/Documentation.pdf','_blank')">Documentation</div>
          <div onclick="window.open('https://github.com/kostasKar/logoMor','_blank')">GitHub Page</div>
        </div>
      </div>
      <div class="show-on-hover dropdown">
        <div class="dropdown-button">Theme</div>
        <div class="dropdown-content">
          <div onclick="setTheme('dark')">Dark</div>
          <div onclick="setTheme('light')">Light</div>
        </div>
      </div>
    </div>

    <div id="editorPanelheader" class="areaDiv">
      <label class="areaTitle brightText">Source Code Editor</label>
      <div onclick="document.getElementById('projectNameInputField').focus()" id="projectNameContainer">
        <input type="text" id="projectNameInputField" placeholder="Sketch Name"
               onfocusin="this.select();document.getElementById('projectNameContainer').classList.add('editing')"
               onchange="this.blur()"
               onkeyup="if(event.key === 'Enter'){this.blur()}"
               onfocusout="document.getElementById('projectNameContainer').classList.remove('editing')">
      </div>
    </div>

    <div id="sourceCodeContainer" class="rtl">
      <textarea class="codeFont" id="sourceCodeTextArea" spellcheck="false" placeholder="Logo code here..."></textarea>
    </div>
    <div id="pull-tab"></div>

    <div class="areaDiv fixedWidth" id="movesLimitDiv">
      <button title="Start debugging" class="btn smallButton" id="debugButton" onclick="LM.interpreter.setup(null, true)">Debug</button><!--
      --><button title="Run to breakpoint" class="btn smallButton" id="debugContinueButton" onclick="LM.debugger.continuePressed()" disabled>Continue</button><!--
      --><button title="Run next command" class="btn smallButton" id="debugStepButton" onclick="LM.debugger.stepPressed()" disabled>Step</button>
      <input  id="movesLimitInput" type="number" name="quantity" min="0" placeholder="Infinite" onchange="LM.interpreter.movesLimit = this.value || Infinity; LM.retainMode.fireExecution()">
      <label title="Maximum number of move commands per frame" class="subtleText1" id="movesLimitLabel">Moves Limit:</label>
    </div>

    <div class="areaDiv fixedWidth" id = "buttonDiv">
      <button class="btn bigButton" id="playButton" onclick="LM.interpreter.setup()">Run</button><!-- just to get rid of the space between the inline-blocks
        --><button class="btn bigButton" id="stopButton" onclick="LM.interpreter.setup(''); LM.sounds.stopAllAudio()">Stop</button>
    </div>

    <div class="areaDiv fixedWidth" id="consoleDiv">
      <label title="Program output (print command), system and error messages dispayed here" class="areaTitle brightText">Console</label>
      <div readonly id="consoleTextArea" class="codeFont brightText"></div>
    </div>

    <div class="areaDiv fixedWidth" id="variablesDiv">
      <label title="Manipulate the initial value of any global variable defined in the source code. Changes can be observed on the drawing in real time" class="areaTitle brightText">Variables Manipulators</label>
      <div class="dropdown">
        <button class="dropbtn btn mediumButton" id="slidersAddButton" onclick="LM.variableManipulatorsSliders.showVariablesNames()" disabled>Add</button><!--
        --><button class="dropbtn btn mediumButton" id="slidersClearButton" onclick="LM.variableManipulatorsSliders.clearSliders()" disabled>Clear</button>
        <div id="variablesNamesDropdown" class="dropdown-content">
        </div>
      </div>
    </div>

    <div class="areaDiv fixedWidth" id="assetsDiv">
      <label title="Import models, images or sounds from local disk" class="areaTitle brightText">Assets</label>
      <button id="assetsAddButton" class="btn mediumButton dropbtn">Add</button>
      <div id="assetsDropDown" class="dropdown-content menu-dropdown-content brightText">
        <div title="Import an .stl or .obj 3D model file from local disk" onclick="LM.models.openModelFile()">Model</div>
        <div title="Import any image file from local disk" onclick="LM.images.openImageFile()">Image</div>
        <div title="Import any audio file from local disk" onclick="LM.sounds.openSoundFile()">Sound</div>
      </div>
      <div class="areaDiv" id="modelsDiv">
        <input id="modelinp" type='file' style="display:none;" onchange="LM.models.readModelFile(event)" onclick="this.value=null;" accept=".stl,.obj" />
      </div>

      <div class="areaDiv" id="imagesDiv">
        <input id="imageinp" type='file' style="display:none;" onchange="LM.images.readImageFile(event)" onclick="this.value=null;" accept="image/*"/>
      </div>

      <div class="areaDiv" id="soundsDiv">
        <input id="soundinp" type='file' style="display:none;" onchange="LM.sounds.readSoundFile(event)" onclick="this.value=null;" accept="audio/*"/>
      </div>
    </div>
    <script>
      document.getElementById("assetsAddButton").addEventListener("click", function(){document.getElementById("assetsDropDown").classList.toggle("show")})
    </script>


  </div>
</div>


<div id="viewPanelControls">
  <button class="tooltip btn circularButton" id="collapseControlsColumn" onclick="document.getElementById('controlsColumnScroll').classList.toggle('hide')">
    <i class="fa fa-code" aria-hidden="true"></i>
    <span class="tooltiptext left">Code Column</span>
  </button>
  <button class="tooltip btn circularButton" id="saveScreenshot" onclick="LM.localSystem.saveScreenshot()">
    <i class="fa fa-camera" aria-hidden="true"></i>
    <span class="tooltiptext left">Screenshot</span>
  </button>
  <button class="tooltip btn circularButton" id="record" onclick="LM.localSystem.toggleRecording()">
    <i class="fa fa-video" aria-hidden="true"></i>
    <span class="tooltiptext left">Video</span>
  </button>
  <button class="tooltip btn circularButton" id="pause" onclick="LM.retainMode.togglePause()">
    <i class="fa fa-pause" aria-hidden="true"></i>
    <span class="tooltiptext left">Redrawing</span>
  </button>
  <button class="tooltip btn circularButton" id="viewSettings">
    <span class="tooltiptext left">View Settings</span>
  </button>
  <div id="extraControls">
    <button class="tooltip btn circularButton toggleButton" id="fullScreenToggleButton" onclick="LM.p5Renderer.toggleFullscreen()">
      <i class="fa fa-expand" aria-hidden="true"></i>
      <span class="tooltiptext left">Fullscreen</span>
    </button>
    <button class="tooltip btn circularButton toggleButton" onclick="LM.cameraViewControl.toggleAutoRotate()">
      <i class="fa fa-sync-alt" aria-hidden="true"></i>
      <span class="tooltiptext left">Auto-Rotate</span>
    </button>
    <button class="tooltip btn circularButton toggleButton" onclick="LM.logo.toggleHelpArrows()">
      <i class="fa fa-compass" aria-hidden="true"></i>
      <span class="tooltiptext left">Orientation</span>
    </button>
    <button class="tooltip btn circularButton toggleButton" onclick="LM.cameraViewControl.toggleAvatarView()">
      <i class="fa fa-crosshairs" aria-hidden="true"></i>
      <span class="tooltiptext left">Track Avatar</span>
    </button>
<!--    <button class="tooltip btn circularButton toggleButton" onclick="LM.p5Renderer.togglePersistDraw()">-->
<!--      <i class="fa fa-clone" aria-hidden="true"></i>-->
<!--      <span class="tooltiptext left">Persist Draw</span>-->
<!--    </button>-->
    <button class="tooltip btn circularButton toggleButton" onclick="document.getElementById('lightSource').classList.toggle('show')">
      <i class="fa fa-sun" aria-hidden="true"></i>
      <span class="tooltiptext left">Light Source</span>
    </button>
  </div>
  <script>
    document.getElementsByClassName('toggleButton').forEach(el => {el.addEventListener('click', function(){el.classList.toggle('checked')})});

    document.getElementById('viewSettings').addEventListener('click',function(){
      document.getElementById("extraControls").classList.toggle("show");
      this.classList.toggle("expanded");
    })
  </script>
</div>

<div id="lightSource">
  <input id="lightSourceColorPicker" type="color" value="#808080" onchange="LM.cameraViewControl.setLightSourceColor(this.value)">
</div>

<script>
  document.getElementById("lightSource").addEventListener('mousedown', function(e) {
    LM.cameraViewControl.setLightSourceSettingMode(true);
  }, true);

  document.addEventListener('mouseup', function() {
    LM.cameraViewControl.setLightSourceSettingMode(false);
  }, true);

  document.addEventListener('mousemove', function(event) {
    if (LM.cameraViewControl.isLightSourceSettingModeEnabled()) {
      LM.cameraViewControl.setLightSource(event.clientX, event.clientY);
      let el = document.getElementById("lightSource");
      el.style.left = event.clientX - el.offsetWidth/2 + "px";
      el.style.top = event.clientY - el.offsetHeight/2  + "px";
    }
  }, true);

  function setTheme(newTheme){
    if (newTheme === "light"){
      document.documentElement.classList.remove('dark-mode');
      document.documentElement.classList.add('light-mode');
      document.getElementById("defaultPenColorPicker").value = "#808080";
      LM.logo.setDefaultHexColor("#808080");
      document.getElementById("backgroundColorPicker").value = "#fafafa";
      LM.p5Renderer.setBackgroundColor("#fafafa");
      LM.retainMode.fireExecution();
      localStorage.setItem("preferredTheme", "light");
    } else if (newTheme === "dark"){
      document.documentElement.classList.remove('light-mode');
      document.documentElement.classList.add('dark-mode');
      document.getElementById("defaultPenColorPicker").value = "#fafafa";
      LM.logo.setDefaultHexColor("#fafafa");
      document.getElementById("backgroundColorPicker").value = "#101010";
      LM.p5Renderer.setBackgroundColor("#101010");
      LM.retainMode.fireExecution();
      localStorage.setItem("preferredTheme", "dark");
    }
  }

  //set theme to preferred or dark by default
  setTheme(localStorage.getItem("preferredTheme") || "dark");

</script>


</body>
</html>
